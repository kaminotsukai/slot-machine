# Kiro 使用ガイド - 学びと実践

このドキュメントは、Kiro（AI搭載IDE）を使ったことがない方に向けて、実際の使用経験から得られた学びと実践的なTipsをまとめたものです。

## 目次

1. [Kiroとは](#kiroとは)
2. [ステアリングルール](#ステアリングルール)
3. [日本語対応](#日本語対応)
4. [Spec機能](#spec機能)
5. [実践的なTips](#実践的なtips)

---

## Kiroとは

KiroはAIアシスタントが統合されたIDEで、コード生成、リファクタリング、テスト作成などを自然言語で指示できます。

### 主な特徴

- **自然言語でのコード操作**: 「〇〇を実装して」「テストを追加して」などの指示が可能
- **コンテキスト理解**: プロジェクト全体の構造を理解して適切なコードを生成
- **ステアリング機能**: プロジェクト固有のルールや規約をAIに学習させられる
- **Spec機能**: 要件定義から設計、実装までを段階的に進められる

---

## ステアリングルール

ステアリングルールは、Kiroに対してプロジェクト固有の規約やガイドラインを教える仕組みです。

### ステアリングルールの配置場所

```
.kiro/steering/
├── japanese-response.md  # 日本語応答ルール
├── product.md            # プロダクト概要
├── tech.md              # 技術スタック
└── structure.md         # プロジェクト構造
```

### ステアリングルールの種類

#### 1. 常時適用ルール（デフォルト）

すべてのやり取りで自動的に適用されるルール。

**例: `product.md`**
```markdown
# プロダクト概要

## スロットマシンアプリケーション

TypeScriptで構築されたブラウザベースのスロットマシンゲーム...
```

#### 2. 条件付きルール

特定のファイルを開いたときだけ適用されるルール。

**設定方法**: ファイルの先頭にfront-matterを追加

```markdown
---
inclusion: fileMatch
fileMatchPattern: 'README*'
---

# README専用ルール
...
```

#### 3. 手動適用ルール

チャットで`#`を使って明示的に呼び出すルール。

```markdown
---
inclusion: manual
---

# 手動で呼び出すルール
...
```

### ステアリングルールのベストプラクティス

1. **簡潔に**: 長すぎるとAIのコンテキストを圧迫する
2. **具体的に**: 抽象的な指示より具体例を示す
3. **構造化**: 見出しやリストで整理する
4. **更新**: プロジェクトの進化に合わせて更新する

### 推奨ステアリングファイル

このプロジェクトで作成した3つのファイルは、どのプロジェクトでも有効です：

- **product.md**: プロダクトの概要、主要機能、アーキテクチャ原則
- **tech.md**: 技術スタック、ビルドコマンド、テスト方法
- **structure.md**: ディレクトリ構成、命名規則、依存関係

---

## 日本語対応

Kiroはデフォルトで英語で応答しますが、ステアリングルールで日本語対応できます。

### 日本語応答ルールの作成

`.kiro/steering/japanese-response.md`を作成：

```markdown
# 日本語応答ルール

## 応答言語
- すべての応答は日本語で行ってください
- 技術的な説明、エラーメッセージの解説、提案なども日本語で記述してください
- 英語の技術用語は必要に応じてそのまま使用して構いません（例：Lambda、S3、CDK）

## コードとドキュメント
- コードコメントは日本語で記述してください
- README、設計書、要件定義などのドキュメントは日本語で作成してください
- 変数名、関数名、クラス名などの識別子は英語を使用してください（コーディング規約に従う）

## 例外
- コードそのもの（変数名、関数名、API呼び出しなど）は英語で記述してください
- 既存の英語ドキュメントを更新する場合は、元の言語を維持してください
- 外部ライブラリやフレームワークの公式用語は英語のまま使用してください
```

### ポイント

- **コードは英語、コメントは日本語**: 国際的な規約に従いつつ、チーム内の理解を促進
- **技術用語はそのまま**: 無理に日本語化せず、一般的な英語用語を使用
- **柔軟性**: 既存ドキュメントの言語は尊重

---

## Spec機能

Specは、要件定義から設計、実装までを段階的に進めるための機能です。

### Specの構造

```
.kiro/specs/
└── slot-app/
    ├── requirements.md  # 要件定義
    ├── design.md       # 設計書
    └── tasks.md        # タスクリスト
```

### Specの使い方

1. **要件定義**: ユーザーストーリーと受け入れ基準を記述
2. **設計**: アーキテクチャ、コンポーネント設計を記述
3. **タスク分解**: 実装タスクを細かく分解
4. **実装**: タスクごとにKiroに指示して実装

### Specのメリット

- **段階的な開発**: 一度にすべてを実装せず、段階的に進められる
- **トレーサビリティ**: 要件から実装までの追跡が可能
- **レビュー可能**: 実装前に設計をレビューできる
- **ドキュメント化**: 自動的にプロジェクトドキュメントが蓄積

### Specファイルでの外部参照

Specファイル内で他のファイルを参照できます：

```markdown
# 設計書

APIスキーマは以下を参照：
#[[file:openapi.yaml]]
```

これにより、OpenAPI仕様やGraphQLスキーマなどを設計に組み込めます。

---

## 実践的なTips

### 1. コンテキストの活用

Kiroは`#`を使ってコンテキストを指定できます：

- `#File`: 特定のファイルを参照
- `#Folder`: フォルダ全体を参照
- `#Problems`: 現在のエラーを参照
- `#Terminal`: ターミナル出力を参照
- `#Git Diff`: Git差分を参照
- `#Codebase`: コードベース全体を検索（インデックス後）

**例**:
```
#File src/GameEngine.ts のテストを追加して
```

### 2. 段階的な指示

一度に大きな変更を指示するより、小さな変更を段階的に指示する方が成功率が高いです。

**悪い例**:
```
アプリ全体をリファクタリングして、テストも追加して、ドキュメントも更新して
```

**良い例**:
```
1. StateManagerをリファクタリングして
2. （完了後）StateManagerのテストを追加して
3. （完了後）READMEを更新して
```

### 3. エラーハンドリング

Kiroが生成したコードにエラーがある場合：

1. `#Problems`を使ってエラーを共有
2. 具体的なエラーメッセージをコピー
3. 「このエラーを修正して」と指示

### 4. コードレビュー

Kiroにコードレビューを依頼できます：

```
#File src/GameEngine.ts をレビューして、改善点を教えて
```

### 5. テスト生成

テストは具体的に指示すると良い結果が得られます：

```
GameEngine.initiateSpin()のテストを追加して。
以下のケースをカバーしてください：
- 正常系: IDLE状態からスピン開始
- 異常系: SPINNING状態でスピン開始（エラー）
- 異常系: SHOWING_RESULTS状態でスピン開始（エラー）
```

### 6. ドキュメント生成

既存のコードからドキュメントを生成できます：

```
src/ディレクトリのコンポーネントについて、
アーキテクチャドキュメントを作成して
```

### 7. リファクタリング

リファクタリングは目的を明確に：

```
ReelManagerをリファクタリングして、
シンボル生成ロジックを別クラスに分離してください。
テストは既存のものが通るようにしてください。
```

### 8. コミットメッセージ

Kiroにコミットを依頼すると、適切なメッセージを生成してくれます：

```
ステアリングルールをコミットして
```

結果：
```
Add steering rules for AI assistant guidance

- product.md: プロダクト概要と主要機能
- tech.md: 技術スタック、ビルドシステム、よく使うコマンド
- structure.md: プロジェクト構造、命名規則、アーキテクチャパターン
```

---

## よくある質問

### Q: ステアリングルールはどのくらい詳細に書くべき？

A: 簡潔に、しかし具体的に。1ファイル100-300行程度が目安です。長すぎるとAIのコンテキストを圧迫します。

### Q: 既存プロジェクトにKiroを導入する場合、何から始めるべき？

A: 以下の順序がおすすめです：
1. `japanese-response.md`（日本語対応）
2. `product.md`（プロダクト概要）
3. `tech.md`（技術スタック）
4. `structure.md`（プロジェクト構造）

### Q: Kiroが期待通りのコードを生成しない場合は？

A: 以下を試してください：
1. より具体的な指示を出す
2. 既存のコード例を`#File`で参照する
3. ステアリングルールに規約を追加する
4. 段階的に小さな変更を指示する

### Q: ステアリングルールは他のプロジェクトでも使える？

A: はい。特に`japanese-response.md`は汎用的です。`product.md`、`tech.md`、`structure.md`はプロジェクトごとにカスタマイズが必要です。

---

## まとめ

Kiroを効果的に使うためのポイント：

1. **ステアリングルールを設定**: プロジェクトの規約をAIに教える
2. **日本語対応**: `japanese-response.md`で日本語環境を構築
3. **段階的な指示**: 小さな変更を積み重ねる
4. **コンテキストを活用**: `#File`、`#Folder`などで適切な情報を提供
5. **Spec機能**: 大きな機能は要件定義から段階的に進める

Kiroは強力なツールですが、適切な指示とコンテキストがあってこそ真価を発揮します。このガイドが、Kiroを使った開発の助けになれば幸いです。

---

## 参考リンク

- Kiro公式ドキュメント: [https://kiro.ai/docs](https://kiro.ai/docs)
- このプロジェクトのステアリングルール: `.kiro/steering/`
- このプロジェクトのSpec: `.kiro/specs/slot-app/`
